<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8" />  
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />  
    <meta http-equiv="x-ua-compatible" content="ie=edge" />  
    <title>Pyserini Reproductions: M-BEIR Datasets</title>  
    <!-- Font Awesome -->  
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" />  
    <!-- Google Fonts Roboto -->  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" />  
    <!-- MDB -->  
   <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/4.0.0/mdb.min.css" rel="stylesheet" />  
  
    <style>  
tr.hide-table-padding td {  
  padding: 0;  
}  
  
.expand-button {  
  position: relative;  
}  
  
.accordion-toggle .expand-button:after {  
  position: absolute;  
  left:.75rem;  
  top: 50%;  
  transform: translate(0, -50%);  
  content: '-';  
}  
  
.accordion-toggle.collapsed .expand-button:after {  
  content: '+';  
}  
  
blockquote.mycode {  
  border-left: 3px solid #ccc;  
  margin-left: 25px;  
  margin-top: 15px;  
  padding-left: 15px;  
}  
  
blockquote.mycode2 {  
  border-left: 3px solid #ccc;  
  margin-left: 25px;  
  padding-top: 10px;  
  padding-bottom: 10px;  
  padding-left: 15px;  
}  
  
tr th.headertop {  
  border-bottom: none;  
  padding-bottom: 0rem  
}  
  
tr th.headerbottom {  
  padding-top: 0rem  
}  
  
.table>:not(caption)>*>*{padding:0.75rem 0.75rem}  
  
.copy-code-button {  
	border-radius: 0;  
	min-width: 55px;  
	background: none repeat scroll 0 0 transparent;  
	background-color: grey;  
	color: #F1F2F3 !important;  
	cursor: pointer;  
	border-style: none;  
	font-family: 'HELVETICA',sans-serif;  
	font-size: 0.8em;  
	font-weight: normal;  
	text-align: center;  
	text-decoration: none;  
	text-indent: 0;  
	text-transform: uppercase;  
	font-weight: 500;  
	line-height: 1.42rem;  
	margin: 0;  
	padding: 3px 8px;  
	position: absolute !important;  
	top: 0 !important;  
	right: 0 !important;  
}  
  
.copy-code-button > span {  
	color: #F1F2F3 !important;  
}  
  
.copy-code-button, ::before, ::after {  
	box-sizing: inherit;  
}  
  
.copy-code-button::before {  
	content: '';  
	display: inline-block;  
	width: 16px;  
	height: 16px;  
	margin-right: 3px;  
	background-size: contain;  
	background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTVweCIgaGVpZ2h0PSIxNXB4IiB2aWV3Qm94PSIwIDAgMTUgMTUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUwLjIgKDU1MDQ3KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5QYWdlIDE8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iRmxvdyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkJ0dG5faHRtbCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTgxOS4wMDAwMDAsIC03NTMuMDAwMDAwKSIgZmlsbD0iI0ZGRkZGRiI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0xIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MTkuMDAwMDAwLCA3NTMuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNODIwLjUsNzUzLjVMODIwLjUsNzY1LjVMODM1LjUsNzY1LjVMODM1LjUsNzUzLjVMODIwLjUsNzUzLjUgWiBNODIwLjUsNzU2LjVMODMzLjUsNzU2LjVMODMzLjUsNzY0LjVMODIwLjUsNzY0LjVMODIwLjUsNzU2LjUgWiBNODIyLjUsNzU4LjVMODIyLjUsNzYyLjVMMzEuNSw3NjIuNUwzMS41LDc1OC41TDgyMi41LDc1OC41IFogTTgyMi41LDc2MC41TDgyMi41LDc2MC41TDMxLjUsNzYwLjVMMzEuNSw3NjAuNUw4MjIuNSw3NjAuNSBaIiBpZD0iU2hhcGUiIHN0cm9rZT0ibm9uZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS0xIiB4PSI4MjIiIHk9Ijc1OCIgd2lkdGg9IjEwIiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUtMS1Db3B5IiB4PSI4MjIiIHk9Ijc2MCIgd2lkdGg9IjEwIiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+");  
	background-repeat: no-repeat;  
	position: relative;  
	top: 3px;  
}  
  
.copy-code-button:focus {  
    outline: 0;  
}  
  
pre[class*="prettyprint"] {  
	position: relative;  
	overflow: hidden;  
}  
    </style>  
</head>  
<body>  
  
    <!-- Background image -->  
    <div id="intro" class="bg-image vh-100 shadow-1-strong" style="max-height: 150px">  
      <div class="mask" style="  
            background: linear-gradient(  
              45deg,  
              rgba(29, 236, 197, 0.7),  
              rgba(91, 14, 214, 0.7) 100%  
            );  
          ">  
        <div class="container d-flex align-items-center justify-content-center text-center h-100"  style="max-height: 150px">  
          <div class="text-white">  
            <h1 class="mb-3"><img width="80" src="../pyserini-logo.png"/> &nbsp; $title</h1>  
          </div>  
        </div>  
      </div>  
    </div>  
    <!-- Background image -->  
  
<div class="container my-4">  
  
<p>The two-click<a href="#" data-mdb-toggle="tooltip" title="What are the two clicks, you ask? Copy and paste!"><sup>*</sup></a> reproduction matrix below provides commands for reproducing experimental results reported in a number of papers, denoted by the references in square brackets.  
Instructions for programmatic execution are shown at the bottom of this page (scroll down).  
  
</p>  
  
<div class="table-responsive">    
  <table class="table">    
  <thead>    
    <tr>    
      <th class="headertop"></th>    
      <th class="headertop"></th>    
      <th class="headertop" colspan="4">  
        <b>CLIP-SF-Large</b>  
        [<a href="#" data-mdb-toggle="tooltip" title="Wei et al. (arXiv 2023) UniIR: Training and Benchmarking Universal Multimodal Information Retrievers.">1</a>]  
      </th>  
      <th class="headertop" colspan="4">  
        <b>BLIP-FF-Large</b>  
        [<a href="#" data-mdb-toggle="tooltip" title="Wei et al. (arXiv 2023) UniIR: Training and Benchmarking Universal Multimodal Information Retrievers.">1</a>]  
      </th>  
    </tr>    
    <tr>    
      <th class="headerbottom" scope="col"></th>    
      <th class="headerbottom" scope="col"></th>    
      <th class="headerbottom" scope="col">R@5</th>    
      <th class="headerbottom" scope="col">R@10</th>  
      <th class="headerbottom" scope="col">S@5</th>  
      <th class="headerbottom" scope="col">S@10</th>  
      <th class="headerbottom" scope="col">R@5</th>  
      <th class="headerbottom" scope="col">R@10</th>  
      <th class="headerbottom" scope="col">S@5</th>  
      <th class="headerbottom" scope="col">S@10</th>  
    </tr>    
  </thead>    
  <tbody>    
$rows    
  </tbody>    
</table>
</div>  
  
<div style="padding-top: 20px"/>    
<h4>Important Note on Score Differences</h4>    
    
<div class="alert alert-warning" role="alert">    
  <h5><i class="fas fa-exclamation-triangle"></i>Recall Calculation Differences</h5>    
  <p>Scores from Pyserini may differ from UniIR's paper as UniIR uses a binary success metric instead of the traditional proportional recall calculation.</p>    
      
  <p><strong>Traditional Recall@K:</strong> (# relevant docs in top-k) / (total # relevant docs)</p>    
  <ul>    
    <li>Returns values between 0.0 and 1.0</li>    
    <li>Accounts for the proportion of relevant documents retrieved</li>    
  </ul>    
      
  <p><strong>UniIR's Recall@K:</strong> Binary success indicator</p>    
  <ul>    
    <li>Returns either 1.0 (success) or 0.0 (failure)</li>    
    <li>Only checks if any relevant document appears in top-k results</li>    
  </ul>    
      
  <p>On datasets with multiple relevant candidates per query, this may lead to substantial score discrepancies between our 2CR runs and the results reported in the original paper.</p>    
</div>  
  
<div style="padding-top: 20px"/>  
<h4>References</h4>  
  
<ul style="list-style-type:none; padding-top: 25px">  
  
<li><p>[1] Cong Wei, Yang Chen, Haonan Chen, Hexiang Hu, Ge Zhang, Jie Fu, Alan Ritter, and Wenhu Chen.  
<a href="https://arxiv.org/abs/2311.17136">UniIR: Training and Benchmarking Universal Multimodal Information Retrievers  
.</a>  
<i>arXiv:2311.17136</i>, November 2023.</p></li>  
  
</ul>  
  
<div style="padding-top: 20px"/>  
  
<h4>Programmatic Execution</h4>  
  
<p>All experimental runs shown in the above table can be programmatically executed based on the instructions below.  
To list all the experimental conditions:</p>  
  
<blockquote class="mycode2"><tt>  
python -m pyserini.2cr.m_beir --list-conditions  
</tt></blockquote>  
  
<p>These conditions correspond to the table rows above.</p>  
  
<p>For all conditions, just show the commands in a "dry run":</p>  
  
<blockquote class="mycode2"><tt>  
python -m pyserini.2cr.m_beir --all --display-commands --dry-run  
</tt></blockquote>  
  
<p>If you want to run the complete regression (i.e., encode the indexes from scratch), download the 4 parts of the image dataset from <a href="https://huggingface.co/datasets/TIGER-Lab/M-BEIR/tree/main">here</a>, merge them into 1 tar.gz file and extract it by following the specified <a href="https://huggingface.co/datasets/TIGER-Lab/M-BEIR/blob/main/README.md#downloading-the-m-beir-dataset">instructions</a>. Make sure the extracted folder is in <code>collections/m-beir</code>.</p>  
  
<blockquote class="mycode2"><tt>  
python -m pyserini.2cr.m_beir --all --display-commands  
</tt></blockquote>  
  
<p>With the above command, run files will be placed in the current directory.  
Use the option <tt>--directory runs/</tt> to place the runs in a sub-directory.</p>  
  
<p>To show the commands for a specific condition:</p>  
  
<blockquote class="mycode2"><tt>  
python -m pyserini.2cr.m_beir --condition clip-sf-large --display-commands --dry-run  
</tt></blockquote>  
  
<p>This will generate exactly the commands for a specific condition above (corresponding to a row in the table).</p>  
  
<p>To actually run a specific condition:</p>  
  
<blockquote class="mycode2"><tt>  
python -m pyserini.2cr.m_beir --condition clip-sf-large --display-commands  
</tt></blockquote>  
  
<p>Again, with the above command, run files will be placed in the current directory.  
Use the option <tt>--directory runs/</tt> to place the runs in a sub-directory.</p>  
  
<p>Finally, to generate this page:</p>  
  
<blockquote class="mycode2"><tt>  
python -m pyserini.2cr.m_beir --generate-report --output m-beir.html  
</tt></blockquote>  
  
<p>The output file <tt>m-beir.html</tt> should be identical to this page.</p>  
  
<div style="padding-top: 50px"/>  
  
      </div>  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>  
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/4.0.0/mdb.min.js"></script>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.10/clipboard.min.js"></script>  
  
<script>
document.querySelectorAll('pre').forEach(function (codeBlock) {
    var button = document.createElement('button');
    button.className = 'copy-code-button';
    button.type = 'button';
    var s = codeBlock.innerText;
    button.setAttribute('data-clipboard-text',s);
    button.innerText = 'Copy';

    // var pre = codeBlock.parentNode;
    codeBlock.classList.add('prettyprint');
    // pre.parentNode.insertBefore(button, pre);
    codeBlock.appendChild(button);
});

var clipboard = new ClipboardJS('.copy-code-button');

clipboard.on('success', function(e) {
  console.info('Action:', e.action);
  console.info('Text:', e.text);
  console.info('Trigger:', e.trigger);
  e.trigger.textContent = 'Copied';
  window.setTimeout(function() {
    e.trigger.textContent = 'Copy';
  }, 2000);
  e.clearSelection();
});

clipboard.on('error', function(e) {
  console.error('Action:', e.action);
  console.error('Trigger:', e.trigger);
  e.trigger.textContent = 'Error Copying';
  window.setTimeout(function() {
    e.trigger.textContent = 'Copy';
  }, 2000);
  e.clearSelection();
});

</script>
  
</body>  
</html>
